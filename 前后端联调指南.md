# 🚀 Pytest Auto API 前后端联调指南

## 📋 快速启动

### 方式1：智能一键启动（推荐）
```bash
# 双击执行，自动修复并启动所有服务
fix_and_start.bat
```

### 方式2：问题诊断和修复
```bash
# 如遇到问题，先运行诊断工具
diagnose_and_fix.bat

# 然后启动服务
fix_and_start.bat
```

## 🔧 已解决的常见问题

### 1. 前端图标导入错误
- **问题**: `Magic` 图标不存在导致路由错误
- **解决**: 自动替换为 `MagicStick` 图标
- **涉及文件**: 
  - `web_ui/frontend/src/views/TestCases/index.vue`
  - `web_ui/frontend/src/views/TestCases/CreateWizard.vue`
  - `web_ui/frontend/src/router/index.js`

### 2. Python依赖缺失
- **问题**: `jsonpath` 包未安装
- **解决**: 自动安装缺失的Python包
- **命令**: `pip install jsonpath`

### 3. 前端依赖问题
- **问题**: `node_modules` 未安装
- **解决**: 自动执行 `npm install`

### 4. 端口配置不一致
- **问题**: Vite配置端口与启动脚本不匹配
- **解决**: 统一使用5173端口

### 5. API代理配置
- **问题**: 前端无法访问后端API
- **解决**: 配置Vite代理转发 `/api` 到 `http://localhost:5000`

## 🌐 服务访问地址

启动成功后，可以访问以下地址：

| 服务 | 地址 | 说明 |
|------|------|------|
| 前端界面 | http://127.0.0.1:5173 | 主要的Web UI界面 |
| 后端API | http://127.0.0.1:5000 | RESTful API服务 |
| 联调测试 | http://127.0.0.1:5173/debug | 前后端通信测试页面 |

## 🧪 联调测试功能

访问 `http://127.0.0.1:5173/debug` 可以：

- ✅ 测试后端服务连通性
- ✅ 验证配置接口
- ✅ 检查用例管理接口
- ✅ 测试执行控制接口
- 📝 查看API响应日志

## 🏗️ 项目架构

```
pytest-auto-api2-master/
├── web_ui/
│   ├── backend/
│   │   └── app.py          # Flask后端服务
│   └── frontend/
│       ├── src/
│       │   ├── views/      # Vue页面组件
│       │   ├── services/   # API服务封装
│       │   └── router/     # 路由配置
│       ├── vite.config.js  # Vite配置
│       └── package.json    # 前端依赖
├── requirements.txt        # Python依赖
├── fix_and_start.bat      # 一键启动脚本
└── diagnose_and_fix.bat   # 诊断修复脚本
```

## 🔍 故障排除

### 如果前端启动失败
1. 运行 `diagnose_and_fix.bat`
2. 检查Node.js版本 (需要16+)
3. 清理缓存: `cd web_ui/frontend && npm cache clean --force`

### 如果后端启动失败
1. 检查Python版本 (需要3.7+)
2. 重新安装依赖: `pip install -r requirements.txt`
3. 检查端口5000是否被占用

### 如果前后端无法通信
1. 访问 `http://127.0.0.1:5173/debug` 进行诊断
2. 检查Vite代理配置是否正确
3. 确认CORS配置已启用

## 📦 主要技术栈

- **后端**: Python + Flask + pytest + allure
- **前端**: Vue 3 + Element Plus + Vite
- **API**: RESTful架构，支持CORS
- **代理**: Vite开发服务器代理

## 🎯 下一步操作

启动成功后，您可以：

1. 📝 **管理测试用例**: 访问"用例管理"页面
2. 🔧 **配置系统**: 访问"配置管理"页面  
3. ▶️ **执行测试**: 访问"执行中心"页面
4. 📊 **查看报告**: 访问"报告中心"页面
5. 🛠️ **使用工具**: 访问"工具箱"页面

## 🆘 获取帮助

如果遇到其他问题：

1. 检查控制台错误日志
2. 访问调试页面进行详细诊断
3. 重新运行诊断修复工具
4. 查看项目文档和源代码

---

**享受自动化测试的便利！** 🎉 